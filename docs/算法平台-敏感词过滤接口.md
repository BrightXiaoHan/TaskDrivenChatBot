# 算法平台-敏感词过滤接口

## 敏感词训练接口

请求方法
- POST

请求地址
- http://{ip}:{port}/xiaoyu/sensitive_words/train

参数说明

| 参数名称 | 参数类型 | 参数描述                                        |
| -------- | -------- | ----------------------------------------------- |
| robot_id | str      | 标识当前faq数据属于哪个机器人，机器人的唯一标识 |
| label    | str      | 每个机器人支持做个敏感词库，不同的敏感词库使用label进行标识 |
| words    | array    | 敏感词，只支持全量更新，不支持增删改            |

请求示例

```http
POST http://{ip}:{port}/xiaoyu/faq HTTP/1.1
Content-Type: application/json

{
	"robot_id": "robot_one",
  "words": [
    "特么",
    "妈的"
  ]
}
```
返回示例
```json
{
    "status": "200",
    "msg": "请求成功"
}
```

参数说明

| 参数名称 | 参数类型 | 参数描述                                |
| -------- | -------- | --------------------------------------- |
| status   | str      | 服务状态码，200为请求成功，500为系统内部错误 |
| msg     | str     | 如果状态码是200则返回“请求成功”，如果状态码是500则返回错误堆栈信息，方便调试              |



## 敏感词分析过滤接口
请求方法
- POST

请求地址
- http://{ip}:{port}/xiaoyu/sensitive_words

参数说明

| 参数名称 | 参数类型 | 参数描述                                        |
| -------- | -------- | ----------------------------------------------- |
| robot_id | str      | 标识当前多轮对话nlu数据属于哪个机器人，机器人的唯一标识 |
| text     | str      | 待分析敏感词的文本                        |
| labels    | array      | 通过label指定采用哪个类型的敏感词库，可以同时指定多个，多个敏感词库会同时生效 |
| strict   | bool     | 是否严格匹配，如果为否，则会使用拼音、简繁体字转换进行模糊匹配 |

请求示例
```
POST http://{ip}:{port}/xiaoyu/multi/nlu HTTP/1.1
Content-Type: application/json

{
    "robot_id": "robot_one",
    "text": "你特么长没长眼睛啊。",
    "labels": ["label1"]
    "strict": true
}
```

返回参数

| 参数名称 | 参数类型 | 参数描述                                |
| -------- | -------- | --------------------------------------- |
| status   | str      | 服务状态码，200为请求成功，500为系统内部错误 |
| msg     | str     | 如果状态码是200则返回“请求成功”，如果状态码是500则返回错误堆栈信息，方便调试              |
| data     | dict      | 文本的分析结果，只有在`status`为200时会返回此番薯             |

`data`参数格式

| 参数名称 | 参数类型 | 参数描述                                |
| -------- | -------- | --------------------------------------- |
| text     | str      | 原文本 |
| masked_text | str | 使用`**`号替换敏感词后的文本 。 ｜
| sentiment     | float      | 情感分析结果，数值范围为0-1之间，0为完全负面，1为完全正面          |
| sensitive_words   | list     | 抽取到的敏感词的信息，为数组形式，数组的每个元素是一个字典，字典包含的字段说明如下 |

`masked_text`参数格式

| 参数名称 | 参数类型 | 参数描述                                |
| -------- | -------- | --------------------------------------- |
| word     | str      | 敏感词文本 |
| start    | int      | 敏感词的起始位置 ｜
| end      | int      | 敏感词的结束为止 |
| label    | str      | 当前敏感词术语哪个label标签  |


返回示例
```json
{
    "status": "200",
    "msg": "请求成功",
    "data": {
        "text": "你特么没长眼睛啊。",
        "masked_text": "你****没长眼睛啊。",
        "sentiment": 0.1,
        "sensitive_words": [
            {
                "word": "特么",
                "start": 1,
                "end": 3,
                "label": "label1"
            }
        ]
    }
}
```
