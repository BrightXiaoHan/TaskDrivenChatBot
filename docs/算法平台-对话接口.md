 

# 一、 通用配置

1、URL地址通用前缀：

http://ip:port/

2、通用Header参数：

``````
Content-Type:application/json

Authorization:XXXXXXXXXXXXXX

Authorization是包头验证信息 Authorization的值为MD5(APISecret +冒号+时间戳)，APISecret 在小语平台配置。时间戳以"yyyyMMdd"。
``````

3、通用返回参数：

| 参数名 | 必填 | 类型   | 说明            |
| ------ | ---- | ------ | --------------- |
| code   | 是   | Int    | 状态码,见附表一 |
| msg    | 是   | String | 返回消息内容    |
| data   | 否   | Object | 返回数据对象    |

示例：

``````
{

“code”：200

“msg”: "操作成功"

}
``````

# 二、 对话回复接口

1、描述：监控算法平台在运行过程中的错误信息。（现在对话回复接口也合并了建立连接接口的功能，如果用户未建立连接，则需要调用方生成sessionId并传递到此接口，此接口检测到sessionId不存在则会自动创建会话）

2、请求地址：http://ip:post/api/v1/session/reply

3、请求方式：post

4、请求参数：

| 参数名    | 必填 | 类型   | 说明         |
| --------- | ---- | ------ | ------------ |
| robotId   | 是   | String | 机器人编码   |
| userCode  | 是   | String | 用户编码     |
| sessionId | 是   | String | 会话ID       |
| userSays  | 是   | String | 用户说的内容 |
| userCode | 否   | String | 用户编码，当为新建立的会话时需要填写此参数，默认值为空     |
| params   | 否   | dict   | 全局参数，当为新建立的会话时需要填写此参数，默认值为空     |
| perspective  | 否   | String | 视角编码 |
| knowledgetype  | 否   | String | 知识分类 |
| recommendNum  | 否   | String | 推荐数量 |
| ans_threshold  | 否   | float | FAQ回答问题的阈值 0-1之间，语义相似度大于阈值才会直接返回答案 |
| rcm_threshold | 否 | float | FAQ推荐问题的阈值 0-1之间，语义相似度大于阈值才会进行推荐 |

5、返回data参数：

data参数：

| 参数名       | 必填 | 类型   | 说明                                             |
| ------------ | ---- | ------ | ------------------------------------------------ |
| sessionId    | 是   | String | 会话ID，当前启动的会话ID，一次会话ID具有唯一性   |
| type         | 是   | String | 问答类型：1、一问一答/2、多轮对话/3、闲聊        |
| trafficManual| 是   | boolean | 是否转人工话务,true是，false否        |
| responseTime | 是   | String | 响应时间（yyyy-MM-dd HH:mi:ss.fff）精确到毫秒3位 |
| userSays     | 是   | String | 用户说的内容 |
| says         | 是   | String | 机器人说的内容                                   |
| optional      | 是   | Array   | 供用户选择的多个输入项                            |
| pullBack     | 否   | String | 拉回回复内容                                   |
| dialog       | 否   | Object | 对话流程信息                                     |
| recommendQuestions | 否   | Array  | 推荐问题                                   |
| recommendScores | 否 | Array | 推荐问题的置信度得分                             |
| relatedQuest | 否   | Array  | 用户说的相关问题                                 |
| hotQuestions | 否   | Array  | 常见问题                                         |
| confidence | 否 | float | FAQ命中知识的置信度                                   |
| hit          | 否   | String | FAQ命中知识标题                                  |
| category     | 否   | String | FAQ命中知识分类                                  |
| intent       | 否   | Object | 用户说的NLP意图理解                              |
| slots        | 否   | Object | NLP理解的词槽信息                                |

dialog:

| 参数名 | 必填 | 类型   | 说明                           |
| ------ | ---- | ------ | ------------------------------ |
| code   | 是   | String | 对话流程编码，多轮对话才有值   |
| nodeId | 是   | String | 对话流程节点ID，多轮对话才有值 |
| isEnd  | 是   | String | 对话是否结束（0是，1否）       |

 

relatedQuest:

| 参数名 | 必填 | 类型   | 说明         |
| ------ | ---- | ------ | ------------ |
| id     | 是   | String | ID标识       |
| title  | 是   | String | 相关问题内容 |
| order  | 是   | String | 排序         |

intent:

| 参数名          | 必填 | 类型   | 说明                                     |
| --------------- | ---- | ------ | ---------------------------------------- |
| understanding   | 否   | String | NLP是否理解用户意图：1、己理解/2、未理解 |
| intent          | 否   | String | NLP理解用户意图                          |
| candidateIntent | 否   | String | NLP理解用候选意图                        |

slots对象

| 参数名 | 必填 | 类型   | 说明           |
| ------ | ---- | ------ | -------------- |
| key    | 是   | String | 词槽关键字名称 |
| name   | 是   | String | 词槽名称       |
| value  | 是   | String | 词槽填充的值   |

 

示例：

``````
{

“code”：200,

“msg”: "操作成功",

“data”:{

"sessionId":"7b6c90045063c581efsdfsdssdf74249", 

"responseTime": "2019-05-16 10:16:39",

"says": "XXX（姓名）您好，我是XXX司法局社区矫正电话客服⼩智，现在依据社区矫正监管要求对您发起电话汇报业务，请问现在是否⽅便进⾏电话汇报？",

“intent”:{

"understanding":"1-己理解/2-未理解",

​        "intent":"理解意图",

​        "candidateIntent": "候选意图",

},

"slots":[

​          {

​            "key":"词槽关键字",

"name":"词槽名称",

​            "value":"抽取填充的实体"

​          }

​        ]

}

}
``````

